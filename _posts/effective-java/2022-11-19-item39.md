---
title: Item 39. ëª…ëª… íŒ¨í„´ë³´ë‹¤ ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë¼
categories: [Effective-Java]
tags: [Annotation]
toc: true

date: 2022-11-19
last_modified_at: 2022-11-19
---

## 1. ë“¤ì–´ê°€ê¸°

ì „í†µì ìœ¼ë¡œ ë„êµ¬ë‚˜ í”„ë ˆì„ì›Œí¬ê°€ íŠ¹ë³„íˆ ë‹¤ë¤„ì•¼ í•  í”„ë¡œê·¸ë¨ ìš”ì†Œì—ëŠ” ëª…ëª… íŒ¨í„´ì„ ì ìš©í–ˆì—ˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ë©´, Junit 3ì€ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œ ì´ë¦„ì„ `test`ë¡œ ì‹œì‘í•˜ê²Œ í–ˆìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ ëª…ëª… íŒ¨í„´ì„ ì ìš©í•˜ë©´ ì–´ë–¤ ë¬¸ì œê°€ ë°œìƒí• ê¹Œìš”?

## 2. ëª…ëª… íŒ¨í„´ì˜ ë‹¨ì 

1. ì˜¤íƒ€ë¥¼ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

   ê°œë°œìê°€ ì‹¤ìˆ˜ë¡œ `testSafetyOverride` ëŒ€ì‹  `tsetSafetyOverride` ë¼ ì´ë¦„ì„ ì§“ëŠ”ë‹¤ë©´

   Junit 3ì€ ì´ ë©”ì„œë“œë¥¼ ë¬´ì‹œí•˜ê³  ì§€ë‚˜ì¹˜ê¸° ë•Œë¬¸ì— ê°œë°œìëŠ” í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—

   ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì„œë“œê°€ í†µê³¼í–ˆë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

   <br>

2. ì˜¬ë°”ë¥¸ í”„ë¡œê·¸ë¨ ìš”ì†Œì—ì„œë§Œ ì‚¬ìš©ë˜ë¦¬ë¼ ë³´ì¦í•  ë°©ë²•ì´ ì—†ë‹¤.

   ì˜ˆë¥¼ ë“¤ì–´ ê°œë°œìê°€ ë©”ì„œë“œê°€ ì•„ë‹Œ í´ë˜ìŠ¤ì— `test` í‚¤ì›Œë“œë¥¼ ì ìš©í•œë‹¤ë©´

   í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë¥¼ ìˆ˜í–‰í•˜ê¸¸ ê¸°ëŒ€í•˜ê² ì§€ë§Œ, Junit 3ëŠ” ê°œë°œìê°€ ì˜ë„í•œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

   <br>

3. í”„ë¡œê·¸ë¨ ìš”ì†Œë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•  ë°©ë²•ì´ ì—†ë‹¤.

   ì˜ˆë¥¼ ë“¤ì–´ íŠ¹ì • ì˜ˆì™¸ë¥¼ ë˜ì ¸ì•¼ ì„±ê³µí•˜ëŠ” í…ŒìŠ¤íŠ¸ê°€ ìˆë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.

   ì´ëŸ´ ê²½ìš°, íŠ¹ì • ì˜ˆì™¸ íƒ€ì…ì„ í…ŒìŠ¤íŠ¸ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•´ì•¼ í•˜ëŠ” ìƒí™©ì¸ë°

   ëª…ëª… íŒ¨í„´ìœ¼ë¡œëŠ” ë°©ë²•ì´ ì—†ìŠµë‹ˆë‹¤.

## 3. ì• ë„ˆí…Œì´ì…˜ì˜ ì‚¬ìš©

ì• ë„ˆí…Œì´ì…˜ì€ ëª…ëª… íŒ¨í„´ì˜ ë‹¨ì ì„ ëª¨ë‘ í•´ê²°í•´ì£¼ëŠ” ê°œë…ìœ¼ë¡œ Junit 4ë¶€í„° ì „ë©´ ë„ì…ë˜ì—ˆìŠµë‹ˆë‹¤.

ê·¸ëŸ¼ ì•ì—ì„œ ì„¤ëª…í•œ ëª…ëª… íŒ¨í„´ì˜ ë‹¨ì ì„ ì• ë„ˆí…Œì´ì…˜ìœ¼ë¡œ í•´ê²°í•´ë´…ì‹œë‹¤.

1. ë§ˆì»¤(marker) ì• ë„ˆí…Œì´ì…˜ì˜ ì‚¬ìš©

   ë§ˆì»¤ ì• ë„ˆí…Œì´ì…˜ì€ ì•„ë¬´ ë§¤ê°œë³€ìˆ˜ ì—†ì´ ë‹¨ìˆœíˆ ë§ˆí‚¹ì— ì‚¬ìš©í•˜ëŠ” ì• ë„ˆí…Œì´ì…˜ì…ë‹ˆë‹¤.

   ```java
    import java.lang.annotation.*;

    @Retention(RetentionPolicy.RUNTIME)
    @Target(ElementType.METHOD)
    public @interface test {

    }
   ```

   ì• ë„ˆí…Œì´ì…˜ ë‚´ë¶€ë¥¼ ë³´ë©´ Retentionê³¼ Target ì• ë„ˆí…Œì´ì…˜ì´ ìˆëŠ”ë°

   ì´ì²˜ëŸ¼ ì• ë„ˆí…Œì´ì…˜ ì„ ì–¸ì— ë‹¤ëŠ” ì• ë„ˆí…Œì´ì…˜ì„ "ë©”íƒ€ ì• ë„ˆí…Œì´ì…˜" ì´ë¼ í•©ë‹ˆë‹¤.

   > * Retention ì• ë„ˆí…Œì´ì…˜
   >
   >   ğŸ”¸ ì• ë„ˆí…Œì´ì…˜ì˜ ë¼ì´í”„ì‚¬ì´í´ì„ ì§€ì •
   >
   >   ğŸ”¹ RetentionPolicy.SOURCE : ì†ŒìŠ¤ ì½”ë“œ(.java)ê¹Œì§€ ë‚¨ì•„ìˆëŠ”ë‹¤.<br>
   >   ğŸ”¹ RetentionPolicy.CLASS : í´ë˜ìŠ¤ íŒŒì¼(.class)ê¹Œì§€ ë‚¨ì•„ìˆëŠ”ë‹¤.(=ë°”ì´íŠ¸ ì½”ë“œ)<br>
   >   ğŸ”¹ RetentionPolicy.RUNTIME : ëŸ°íƒ€ì„ê¹Œì§€ ë‚¨ì•„ìˆëŠ”ë‹¤.(=ì‚¬ì‹¤ìƒ ì•ˆ ì‚¬ë¼ì§„ë‹¤.)

   > * Target ì• ë„ˆí…Œì´ì…˜
   >
   >   ğŸ”¸ì• ë„ˆí…Œì´ì…˜ì˜ ìœ„ì¹˜ ì§€ì •
   >
   >   ğŸ”¹ ElementType.PACKAGE : íŒ¨í‚¤ì§€ ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.TYPE : íƒ€ì… ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.ANNOTATION_TYPE : ì–´ë…¸í…Œì´ì…˜ íƒ€ì… ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.CONSTRUCTOR : ìƒì„±ì ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.FIELD : ë©¤ë²„ ë³€ìˆ˜ ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.LOCAL_VARIABLE : ì§€ì—­ ë³€ìˆ˜ ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.METHOD : ë©”ì„œë“œ ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.PARAMETER : ì „ë‹¬ì¸ì ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.TYPE_PARAMETER : ì „ë‹¬ì¸ì íƒ€ì… ì„ ì–¸<br>
   >   ğŸ”¹ ElementType.TYPE_USE : íƒ€ì… ì„ ì–¸
   
   ë§ˆì»¤ ì• ë„ˆí…Œì´ì…˜ì€ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

   ```java
    public class Sample {
      /* ì„±ê³µ í…ŒìŠ¤íŠ¸ */
      @Test
      public static void successTest() {}
      
      /* ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ */
      @Test
      public static void failTest() {
        throw new RuntimeException("ì‹¤íŒ¨");
      }      


      /* ì˜ëª» ì‚¬ìš©í•œ ì˜ˆ */
      @Test
      public wrongTest1() {}                // ì •ì  ë©”ì„œë“œ x

      public static void wrongTest2() {}    // Test ì• ë„ˆí…Œì´ì…˜ x
    }
   ```

2. í•˜ë‚˜ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ëŠ” ì• ë„ˆí…Œì´ì…˜ì˜ ì‚¬ìš©

   ```java
    import java.lang.annotation.*;

    @Retention(RetentionPolicy.RUNTIME)
    @Target(ElementType.METHOD)
    public @interface ExceptionTest {
      Class<? extends Throwable> value();
    }
   ```

   ì´ ì• ë„ˆí…Œì´ì…˜ì˜ ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì€ `Class<? extends Throwable>` ìœ¼ë¡œ ëª…ì‹œë˜ì–´ ìˆëŠ”ë°

   ì¦‰, Throwableì„ í™•ì¥í•œ í´ë˜ìŠ¤ì˜ Class ê°ì²´ë¼ëŠ” ëœ»ìœ¼ë¡œ ëª¨ë“  ì˜ˆì™¸ íƒ€ì…ì„ ìˆ˜ìš©í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

   í•˜ë‚˜ì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ì• ë„ˆí…Œì´ì…˜ì€ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

   ```java
    public class Sample2 {
      /* ì„±ê³µ í…ŒìŠ¤íŠ¸ */
      @ExceptionTest(ArithmeticException.class)
      public static void success() {
        int i = 0;
        i = i / i;
      }

      /* ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ (ë‹¤ë¥¸ ì˜ˆì™¸ ë°œìƒ) */
      @ExceptionTest(ArithmeticException.class)
      public static void fail1() {
        int[] a = new int[0];
        int i = a[1];
      }

      /* ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ (ì˜ˆì™¸ ë°œìƒ x) */
      @ExceptionTest(ArithmeticException.class)
      public static void fail2() {
        
      }
    }
   ```

3. ì—¬ëŸ¬ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ëŠ” ì• ë„ˆí…Œì´ì…˜ì˜ ì‚¬ìš©

   ì—¬ëŸ¬ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ì„ ë•ŒëŠ” ë°°ì—´ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

   ```java
    import java.lang.annotation.*;

    @Retention(RetentionPolicy.RUNTIME)
    @Target(ElementType.METHOD)
    public @interface ExceptionTest {
      Class<? extends Throwable>[] value();
    }
   ```

   ê·¸ë¦¬ê³  ì—¬ëŸ¬ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” ì• ë„ˆí…Œì´ì…˜ì€ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

   ```java
    public class Sample3 {
      @ExceptionTest({ ArithmeticException.class, NullPointerException.class })
      public static void success() {
        List<String> list = null;
        list.get(0);
      }
    }
   ```

4. Java 8ì—ì„œì˜ ì—¬ëŸ¬ ë§¤ê°œë³€ìˆ˜ë¥¼ ë°›ëŠ” ì• ë„ˆí…Œì´ì…˜ì˜ ì‚¬ìš©

   ë°°ì—´ ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  ì• ë„ˆí…Œì´ì…˜ì— @Repeatable ë©”íƒ€ ì• ë„ˆí…Œì´ì…˜ì„ ë‹¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

   í•˜ì§€ë§Œ, ì—¬ê¸°ì„œ ëì´ ì•„ë‹ˆë¼ ì»¨í…Œì´ë„ˆ ì• ë„ˆí…Œì´ì…˜ì„ í•˜ë‚˜ ë” ì •ì˜í•˜ê³ ,

   @Repeatableì— ì»¨í…Œì´ë„ˆ ì• ë„ˆí…Œì´ì…˜ì˜ class ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.

   ```java
    import java.lang.annotation.*;

    @Retention(RetentionPolicy.RUNTIME)
    @Target(ElementType.METHOD)
    @Repeatable(ExceptionTestContainer.class)
    public @interface ExceptionTest {
      Class<? extends Throwable> value();
    }

    @Retention(RetentionPolicy.RUNTIME)
    @Target(ElementType.METHOD)
    public @interface ExceptionTestContainer {
      ExceptionTest[] value();
    }
   ```

   ```java
    public class Sample4 {
      @ExceptionTest(ArithmeticException.class)
      @ExceptionTest(NullPointerException.class)
      public static void success() {
        List<String> list = null;
        list.get(0);
      }
    }
   ```

## 4. ì •ë¦¬

ì´ë²ˆ í¬ìŠ¤íŠ¸ëŠ” ëª…ëª… íŒ¨í„´ì˜ ë‹¨ì ì„ ì• ë„ˆí…Œì´ì…˜ìœ¼ë¡œ í•´ê²°í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.

ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì• ë„ˆí…Œì´ì…˜ì´ ëª…ëª… íŒ¨í„´ë³´ë‹¤ ë‚«ê¸° ë•Œë¬¸ì—

ì• ë„ˆí…Œì´ì…˜ìœ¼ë¡œ í•  ìˆ˜ ìˆëŠ” ì¼ì„ êµ³ì´ ëª…ëª… íŒ¨í„´ìœ¼ë¡œ ì²˜ë¦¬í•  ì´ìœ ëŠ” ì—†ìœ¼ë¯€ë¡œ ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•©ì‹œë‹¤.