---
title: Item 37. ordinal ì¸ë±ì‹± ëŒ€ì‹  EnumMapì„ ì‚¬ìš©í•˜ë¼
categories: [Effective-Java]
tags: [Enum]
toc: true

date: 2022-10-29
last_modified_at: 2022-10-29
---

## 1. ë“¤ì–´ê°€ê¸°

Enumì„ ì‚¬ìš©í•œ ë°°ì—´ì´ë‚˜ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì›ì†Œë¥¼ êº¼ë‚¼ ë•Œ, ordinal ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.

```java
  class Plant {
    enum LifeCycle { ANNUAL, PERENNIAL, BIENNIAL }

    final String name;
    final LifeCycle lifeCycle;

    Plant(String name, LifeCycle lifeCycle) {
      this.name = name;
      this.lifeCycle = lifeCycle;
    }

    @Override
    public String toString() {
      return name;
    }
  }
```

```java
  Set<Plant>[] plantsByLifeCycle = (Set<Plant>[]) new Set[Plant.LifeCycle.values().length];

  for(int i=0; i<plantsByLifeCycle.length; i++)
    plantsByLifeCycle[i] = new HashSet<>();

  for(Plant p : garden)
    plantsByLifeCycle[p.lifeCycle.ordinal()].add(p);

  for (int i=0; i<plantsByLifeCycle.length; i++)
    System.out.printf("%s : %s%n", LifeCycle.values()[i], plantsByLifeCycle[i]);
```

ì •ì›ì— ì‹¬ì€ ì‹ë¬¼ë“¤ì„ ìƒì• ì£¼ê¸° ë³„ë¡œ ê´€ë¦¬í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

ìœ„ì˜ ì½”ë“œëŠ” ë™ì‘ì€ í•˜ì§€ë§Œ ë‹¤ìŒì˜ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.

## 2. ordinal ë©”ì„œë“œë¥¼ ì¸ë±ìŠ¤ë¡œ ì‚¬ìš©í•œ ì½”ë“œì˜ ë¬¸ì œì 

1. ë¹„ê²€ì‚¬ í˜•ë³€í™˜ì„ ìˆ˜í–‰í•´ì•¼í•œë‹¤.

   ğŸ”¹ë°°ì—´ì€ ì œë„¤ë¦­ê³¼ í˜¸í™˜ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¹„ê²€ì‚¬ í˜•ë³€í™˜ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

   ğŸ”¹`Set<Plant>[] plantsByLifeCycle = (Set<Plant>[]) new Set[Plant.LifeCycle.values().length];`

   <br>

2. ì¶œë ¥ ê²°ê³¼ì— ì§ì ‘ ë ˆì´ë¸”ì„ ë‹¬ì•„ì•¼ í•œë‹¤.

   ğŸ”¹`System.out.printf("%s : %s%n", LifeCycle.values()[i], plantsByLifeCycle[i]);`

   <br>

3. ì˜ëª»ëœ ê°’ì„ ì‚¬ìš©í•  ìœ„í—˜ì´ ìˆë‹¤.

   ğŸ”¹ì˜ëª»ëœ ë™ì‘ì„ ìˆ˜í–‰í•˜ê±°ë‚˜, ArrayIndexOutOfBoundsExceptionì„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 3. í•´ê²°ë²•

ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ì¢‹ì€ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œë¥¼ ì²œì²œíˆ ì‚´í´ë³´ë©´ ì‹¤ì§ˆì ìœ¼ë¡œ ë°°ì—´ì€ ì—´ê±° íƒ€ì… ìƒìˆ˜ë¥¼ ê°’ìœ¼ë¡œ ë§¤í•‘í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.

ê·¸ë ‡ê¸° ë•Œë¬¸ì— Mapì„ ì‚¬ìš©í•  ìˆ˜ ìˆê³  íŠ¹íˆ, ì—´ê±° íƒ€ì…ì„ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” EnumMapì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ìœ„ì˜ ì˜ˆì‹œë¥¼ EnumMapìœ¼ë¡œ ëŒ€ì²´í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```java
  Map<Plant.LifeCycle, Set<Plant>> plantsByLifeCycle = new EnumMap<>(Plant.LifeCycle.class);
                  
  for (Plant.LifeCycle lc : Plant.LifeCycle.values())
    plantsByLifeCycle.put(lc, new HashSet<>());

  for (Plant p : garden)
    plantsByLifeCycle.get(p.lifeCycle).add(p);

  System.out.println(plantsByLifeCycle);
```

EnumMapì„ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒì˜ ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.

1. EnumMap ë‚´ë¶€ì ìœ¼ë¡œ ë°°ì—´ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë°°ì—´ì„ ì‚¬ìš©í•œ ì½”ë“œì™€ ì„±ëŠ¥ì´ ë¹„ìŠ·í•˜ë‹¤.

2. EnumMapì˜ í‚¤ íƒ€ì…ì€ í•œì •ì  íƒ€ì… í† í°ì´ë¯€ë¡œ ì•ˆì „í•˜ì§€ ì•ŠëŠ” í˜•ë³€í™˜ì„ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ë‹¤.

3. ì—´ê±° íƒ€ì…ì„ í‚¤ë¡œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì¶œë ¥ ê²°ê³¼ì— ì§ì ‘ ë ˆì´ë¸”ì„ ë‹¬ í•„ìš”ê°€ ì—†ë‹¤.

4. ë°°ì—´ ì¸ë±ìŠ¤ë¥¼ ê³„ì‚°í•˜ëŠ” ê³¼ì •ì—ì„œ ì˜¤ë¥˜ê°€ ë‚  ê°€ëŠ¥ì„±ì´ ì—†ë‹¤.

## 4. Streamì„ ì´ìš©í•œ EnumMap

Java 8ì—ì„œ ì¶”ê°€ëœ Streamì„ ì´ìš©í•˜ë©´ ì½”ë“œë¥¼ ë” ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
  Arrays.stream(garden)
        .collect(groupingBy(p -> p.lifeCycle, () -> new EnumMap<>(LifeCycle.class), toSet()));
```

ì´ëŠ” ìµœì í™”ë¥¼ ì´ë¤„ë‚¼ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ë„ ìˆìŠµë‹ˆë‹¤.

Streamì„ ì´ìš©í•˜ì§€ ì•ŠëŠ” ì˜ˆì‹œëŠ” ë¬´ì¡°ê±´ ì‹ë¬¼ì˜ ìƒì• ì£¼ê¸° ë‹¹ í•˜ë‚˜ì”©ì˜ ì¤‘ì²© Mapì„ ë§Œë“¤ì§€ë§Œ,

Streamì„ ì´ìš©í•˜ë©´ í•´ë‹¹ ìƒì• ì£¼ê¸°ì— ì†í•˜ëŠ” ì‹ë¬¼ì´ ìˆì„ ë•Œë§Œ ì¤‘ì²© Mapì„ ë§Œë“­ë‹ˆë‹¤.

## 5. Streamì„ ì´ìš©í•œ EnumMap ì‹¬í™”

ì´ë²ˆì—ëŠ” ordinalì„ ë‘ ë²ˆ ì‚¬ìš©í•œ ì˜ˆì‹œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

```java
  public enum Phase {
    SOLID, LIQUID, GAS;

    public enum Transition {
      MELT, FREEZE, BOIL, CONDENSE, SUBLIME, DEPOSIT;

      private static final Transition[][] TRANSITIONS = {
        {null, MELT, SUBLIME},
        {FREEZE, null, BOIL},
        {DEPOSIT, CONDENSE, null}
      };

      public static Transition from(Phase from, Phase to) {
        return TRANSITIONS[from.ordinal()][to.ordinal()];
      }
    }
}
```

ìœ„ì˜ ì˜ˆì‹œëŠ” ë‘ ê°€ì§€ ìƒíƒœ(Phase)ë¥¼ ì „ì´(transition)ì™€ ë§¤í•‘í•˜ë„ë¡ êµ¬í˜„í•œ ì½”ë“œì…ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ë©´, ì•¡ì²´(LIQUID)ì—ì„œ ê³ ì²´(SOLID)ë¡œì˜ ì „ì´ëŠ” ì‘ê³ (FREEZE)ì…ë‹ˆë‹¤.

ì´ ì˜ˆì‹œë„ EnumMapìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ ìˆëŠ”ë° ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```java
  public enum Phase {
    SOLID, LIQUID, GAS;

    public enum Transition {
      MELT(SOLID, LIQUID),
      FREEZE(LIQUID, SOLID),
      BOIL(LIQUID, GAS),
      CONDENSE(GAS, LIQUID),
      SUBLIME(SOLID, GAS),
      DEPOSIT(GAS, SOLID);

      private final Phase from;
      private final Phase to;

      Transition(Phase from, Phase to) {
        this.from = from;
        this.to = to;
      }

      private static final Map<Phase, Map<Phase, Transition>> transitionMap = 
        Stream.of(values())
              .collect(Collectors.groupingBy(
                t -> t.from,                          // ë°”ê¹¥ Mapì˜ Key
                () -> new EnumMap<>(Phase.class),     // ë°”ê¹¥ Mapì˜ êµ¬í˜„ì²´
                Collectors.toMap(
                  t -> t.to,                          // ë°”ê¹¥ Mapì˜ Value(Mapìœ¼ë¡œ), ì•ˆìª½ Mapì˜ Key
                  t -> t,                             // ì•ˆìª½ Mapì˜ Value
                  (x, y) -> y,                        // ì¶©ëŒ ì²˜ë¦¬ ë°©ë²•
                  () -> new EnumMap<>(Phase.class)    // ì•ˆìª½ Mapì˜ êµ¬í˜„ì²´
                )
              ));

      public static Transition from(Phase from, Phase to) {
          return transitionMap.get(from).get(to);
      }
    }
  }
```

ì—¬ê¸°ì„œ ë§Œì•½, `PLASMA`ë¥¼ ì¶”ê°€í•œë‹¤ë©´ EnumMap ì˜ˆì‹œëŠ” Phase 1ê°œ, Transition 2ê°œë§Œ ì¶”ê°€í•´ì£¼ë©´ ë˜ì§€ë§Œ,

ë°°ì—´ ì˜ˆì‹œì—ì„œëŠ” Phase 1ê°œ, Transition 2ê°œì™€ ë”ë¶ˆì–´ TRANSITIONS ìƒíƒœí‘œë„ í•¨ê»˜ ìˆ˜ì •í•´ì¤˜ì•¼ í•˜ê¸°ì—

ìœ ì§€ ë³´ìˆ˜ ì¸¡ë©´ì—ì„œë„ EnumMapì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

## 6. ì •ë¦¬

ë°°ì—´ì˜ ì¸ë±ìŠ¤ë¥¼ ì–»ê¸° ìœ„í•´ ordinal ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ ì¢‹ì§€ ì•Šê¸° ë•Œë¬¸ì—

ë” ì§§ê³  ëª…ë£Œí•˜ê³  ì•ˆì „í•˜ë©° ìœ ì§€ë³´ìˆ˜ ì¸¡ë©´ì—ì„œë„ ì¢‹ì€ EnumMapì„ ì‚¬ìš©í•©ì‹œë‹¤.