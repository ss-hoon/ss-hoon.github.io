---
title: Item 5. 자원을 직접 명시하지 말고 의존 객체 주입을 사용하라
categories: [Effective-Java]
tags: [Web, DI]
toc: true

date: 2022-04-15
last_modified_at: 2022-04-15
---

## 1. 들어가기

의존 객체 주입(Dependency Injection)이란 무엇일까요?

예시를 통해 알아봅시다.

```java
  // 할인 정책 인터페이스
  public interface DiscountPolicy {}

  // 정액 할인, 정률 할인 구체 클래스
  public class FixDiscountPolicy implements DiscountPolicy() {}
  public class RateDiscountPolicy implements DiscountPolicy() {}

  // 할인 클래스
  public class Discount {
    private static final DiscountPolicy discountPolicy = new FixDiscountPolicy();
  }
```

할인 정책(DiscountPolicy)은 보통

정해진 금액만큼 할인해주는 정액 할인(FixDiscountPolicy)과

일정 비율만큼 할인해주는 정률 할인(RateDiscountPolicy)이 있습니다.

만약, 현재 코드에서 정액 할인을 사용하다가 정률 할인으로 변경하고 싶을 때,

할인 클래스는 인터페이스와 구체 클래스를 모두 의존하고 있기 때문에

할인 클래스를 변경해줘야하고 이는 5가지 객체지향 설계 원칙 중 OCP 원칙을 위배하게 됩니다.

> * OCP(Open-Closed Principle)
>
> 소프트웨어 개체는 확장에는 열려있고, 변경에는 닫혀 있어야 한다.

그럼 해당 코드를 어떻게 수정해야 OCP 원칙을 지킬 수 있을까요?

이럴 때, 사용하는 방법이 '의존 객체 주입'입니다.

## 2. 의존 객체 주입(Dependency Injection)

먼저, 예시를 통해 어떻게 의존 객체 주입을 사용하는지 알아봅시다.

```java
  // 할인 정책 인터페이스
  public interface DiscountPolicy {}

  // 정액 할인, 정률 할인 구체 클래스
  public class FixDiscountPolicy implements DiscountPolicy() {}
  public class RateDiscountPolicy implements DiscountPolicy() {}

  // 할인 클래스
  public class Discount {
    private static final DiscountPolicy discountPolicy;

    public Discount(DiscountPolicy discountPolicy) {
      this.discountPolicy = Objects.requireNonNull(discountPolicy);
    }
  }
```

첫 번째 예시의 할인 클래스만 수정을 해보았습니다.

예시를 살펴보면 기존 코드에서 생성자가 하나 추가된 것을 볼 수 있습니다.

외부에서 할인 정책을 생성자를 통해 받아 필드에 넣어주는데 이를 의존 객체 주입이라고 합니다.

수정한 예시의 할인 클래스는 인터페이스만 의존하고 있기 때문에

만약, 정액 할인을 정률 할인으로 변경했을 경우, 할인 클래스 자체를 수정하지 않아도 됩니다.

즉, 확장에는 열려있고, 변경에는 닫혀있는 OCP 원칙을 지키게 됩니다.