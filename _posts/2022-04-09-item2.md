---
title: Item 2. 생성자에 매개변수가 많다면 빌더를 고려하라
categories: [Effective-Java]
tags: [Web, Builder]
toc: true

date: 2022-04-09
last_modified_at: 2022-04-09
---

## 1. 들어가기

생성자는 객체를 생성하는 가장 기본적인 방법입니다.

그리고 생성자 오버로딩을 통해 시그니처가 다른 여러 생성자를 만들 수 있습니다.

그럼 매개변수가 여러 개 있다면 어떻게 구현할 수 있을까요?

이럴 때 개발자들은 보통 '점층적 생성자 패턴' 을 사용했습니다.

점층적 생성자 패턴이 뭘까요?

예시를 보겠습니다.

```
    public class Person {
        private String name;
        private int age;
        private String job;
        private String hobby;

        Person(String name, int age) {
            this(name, age, null);
        }

        Person(String name, int age, String job) {
            this(name, age, job, null);
        }

        Person(String name, int age, String job, String hobby) {
            this.name = name;
            this.age = age;
            this.job = job;
            this.hobby = hobby;
        }
    }
```

이렇게 매개변수를 하나씩 점층적으로 늘려가 생성자를 구현하는 패턴이 '점층적 생성자 패턴' 입니다.

하지만, 매개변수가 10개, 20개가 된다면 어떻게 될까요?

<div class="div-post-img">
  <img src="{{ site.url }}/assets/img/web/02/wtf.png" width="40%" height="30%" />
</div>

분명 생성자만 작성하다가 지칠 것입니다.

즉, 점층적 생성자 패턴도 쓸 수는 있지만, 코드를 작성하기 어렵고 가독성도 떨어집니다.

심지어 위의 예시 코드에서 job과 hobby의 값을 반대로 넣어도

컴파일러는 알지 못해 런타임에 엉뚱한 동작을 하게 됩니다.

그럼 방법이 없는걸까요?

이번에는 또다른 대안인 Java Beans 패턴에 대해 알아보겠습니다.

Java Beans 패턴은 먼저, 매개변수가 없는 생성자로 객체를 만든 후에

setter를 호출해 원하는 매개변수의 값을 설정하는 방식입니다.

이것도 예시를 한번 보겠습니다.

```
    public class Person {
        private String name;
        private int age;
        private String job;
        private String hobby;

        public Person() {}

        public void setName(String name)    { this.name = name; }
        public void setAge(int age)         { this.age = age; }
        public void setJob(String job)      { this.job = job; }
        public void setHobby(String hobby)  { this.hobby = hobby; }
    }

    public static void main(String[] args) {
        Person person = new Person();

        person.setName("이상훈");
        person.setAge(28);
        person.setJob("developer");
        person.setHobby("playing piano");
    }
```

확실히 점층적 생성자 패턴에 비해 인스턴스를 만들기 쉽고, 가독성이 좋아졌습니다.

하지만, 객체 하나를 만들기 위해서는 여러 메서드를 호출해야하고

객체가 완전히 생성되기 전까지는 일관성이 무너진 상태에 놓이게 됩니다.

이 단점을 보완하기 위해 객체를 완전히 생성하기 전까지는 사용하지 못하도록

freezing을 사용하는 방법이 있지만

이는 다루기 어려워 실전에서는 거의 쓰이지 않습니다.

그럼 객체를 생성할 때 메서드를 적게 호출하면서 일관성이 유지되는 방법이 없는걸까요?

지금부터 또 하나의 대안 Builder에 대해서 알아봅시다!

## 2. Builder

Builder가 무엇일까요?

먼저, Builder의 사전적 의미를 알아보면 "건축가" 라는 뜻입니다.

다음 예시를 보면 왜 Builder라는 용어를 사용하는지 알 수 있을 것입니다.

```
    public class Person {
        private String name;
        private int age;
        private String job;
        private String hobby;

        public static class Builder {
            private String name = null;
            private int age = 0;
            private String job = null;
            private String hobby = null;

            public Builder(String name, int age) {
                this.name = name;
                this.age = age;
            }

            public Builder job(String job) {
                this.job = job;
                return this;
            }

            public Builder hobby(String hobby) {
                this.hobby = hobby;
                return this;
            }

            public Person build() {
                return new Person(this);
            }
        }

        private Person(Builder builder) {
            this.name = builder.name;
            this.age = builder.age;
            this.job = builder.job;
            this.hobby = builder.hobby;
        }
    }

    public static void main(String[] args) {
        Person person = new Person.Builder("이상훈", 28)
                                  .job("develop")
                                  .hobby("playing piano")
                                  .build();
    }
```

주의깊게 봐야할 곳은 main 메서드 부분입니다.

부품(job, hobby)을 하나씩 조립하는 느낌이 들지 않나요?

Builder의 setter 메서드들은 Builder 자기 자신을 반환하기 때문에

예시와 같이 연쇄적으로 호출할 수 있습니다.

이런 방식을 메서드 호출이 흐르듯 연결된다는 뜻으로

Fluent API 또는 Method Chaining 이라고 합니다.

그러므로 Builder는 계층적으로 설계된 클래스와 함께 쓰기에 좋습니다.

이번에도 예시를 통해 알아보겠습니다.

```
    
```

(작성중...)

<div class="highlighter-rouge">
  <pre class="highlight">
    <code>
      📕 개인 기록용 블로그입니다.
      😊 오타나 잘못된 정보가 있을 경우 댓글이나 메일로 말씀해주시면 바로 수정하겠습니다! 😊</code>
  </pre>
</div>